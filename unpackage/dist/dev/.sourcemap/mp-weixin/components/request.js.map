{"version":3,"file":"request.js","sources":["components/request.js"],"sourcesContent":["// 定义全局变量来替代 process.env.VUE_APP_API_BASE_URL\nconst BASE_URL = 'https://larsc.hzau.edu.cn/prod-api';\n\nexport const request = (options) => {\n  console.log('Request options:', options);\n  return new Promise((resolve, reject) => {\n    // 处理URL和参数\n    let url = BASE_URL + options.url;\n\n    // 对于GET请求，手动将参数拼接到URL上\n    if (options.method === 'GET' && options.data) {\n      let queryString = '';\n      for (const key in options.data) {\n        if (options.data[key] !== undefined && options.data[key] !== null) {\n          if (queryString) {\n            queryString += '&';\n          }\n          queryString += `${key}=${encodeURIComponent(options.data[key])}`;\n        }\n      }\n      if (queryString) {\n        url += (url.includes('?') ? '&' : '?') + queryString;\n      }\n    }\n\n    uni.request({\n      url: url,\n      method: options.method || 'GET',\n      data: options.method !== 'GET' ? options.data : undefined, // GET请求不传data\n      header: {\n        ...options.headers,\n        'Authorization': options.headers?.Authorization?.trim() // 确保没有多余空格\n      },\n      success: (res) => {\n        if (res.statusCode >= 200 && res.statusCode < 300) {\n          resolve(res.data);\n        } else {\n          reject(new Error(`请求失败，状态码：${res.statusCode}`));\n        }\n      },\n      fail: (err) => {\n        reject(new Error(`网络错误：${err.errMsg}`));\n      }\n    });\n  });\n};"],"names":["uni"],"mappings":";;AACA,MAAM,WAAW;AAEL,MAAC,UAAU,CAAC,YAAY;AAClCA,gBAAA,MAAA,MAAA,OAAA,8BAAY,oBAAoB,OAAO;AACvC,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;;AAEtC,QAAI,MAAM,WAAW,QAAQ;AAG7B,QAAI,QAAQ,WAAW,SAAS,QAAQ,MAAM;AAC5C,UAAI,cAAc;AAClB,iBAAW,OAAO,QAAQ,MAAM;AAC9B,YAAI,QAAQ,KAAK,GAAG,MAAM,UAAa,QAAQ,KAAK,GAAG,MAAM,MAAM;AACjE,cAAI,aAAa;AACf,2BAAe;AAAA,UAChB;AACD,yBAAe,GAAG,GAAG,IAAI,mBAAmB,QAAQ,KAAK,GAAG,CAAC,CAAC;AAAA,QAC/D;AAAA,MACF;AACD,UAAI,aAAa;AACf,gBAAQ,IAAI,SAAS,GAAG,IAAI,MAAM,OAAO;AAAA,MAC1C;AAAA,IACF;AAEDA,kBAAAA,MAAI,QAAQ;AAAA,MACV;AAAA,MACA,QAAQ,QAAQ,UAAU;AAAA,MAC1B,MAAM,QAAQ,WAAW,QAAQ,QAAQ,OAAO;AAAA;AAAA,MAChD,QAAQ;AAAA,QACN,GAAG,QAAQ;AAAA,QACX,kBAAiB,mBAAQ,YAAR,mBAAiB,kBAAjB,mBAAgC;AAAA;AAAA,MAClD;AAAA,MACD,SAAS,CAAC,QAAQ;AAChB,YAAI,IAAI,cAAc,OAAO,IAAI,aAAa,KAAK;AACjD,kBAAQ,IAAI,IAAI;AAAA,QAC1B,OAAe;AACL,iBAAO,IAAI,MAAM,YAAY,IAAI,UAAU,EAAE,CAAC;AAAA,QAC/C;AAAA,MACF;AAAA,MACD,MAAM,CAAC,QAAQ;AACb,eAAO,IAAI,MAAM,QAAQ,IAAI,MAAM,EAAE,CAAC;AAAA,MACvC;AAAA,IACP,CAAK;AAAA,EACL,CAAG;AACH;;"}